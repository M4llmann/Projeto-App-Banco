<div class="content-wrapper">
  <div class="container">
    <header class="header">
      <h1>ğŸ¦ Gerenciador de Conta</h1>
    </header>

    <!-- FormulÃ¡rio para criar conta -->
    <section *ngIf="contas.length === 0 && !loading" class="create-account-section fade-in">
      <h3>Criar Nova Conta</h3>
      <label for="nomeTitular" class="label">Nome do Titular</label>
      <input 
        type="text" 
        id="nomeTitular" 
        [(ngModel)]="nomeTitular" 
        placeholder="Digite o nome completo" 
        class="input-text"
        [disabled]="loadingCriarConta" />
      <button 
        (click)="criarConta()" 
        class="btn-criar-conta"
        [disabled]="loadingCriarConta || !nomeTitular.trim()">
        <span *ngIf="loadingCriarConta" class="loading"></span>
        {{ loadingCriarConta ? 'Criando...' : 'Criar Conta' }}
      </button>
      <div *ngIf="mensagemErro" class="error-section">
        <p class="error-message">{{ mensagemErro }}</p>
      </div>
      <div *ngIf="mensagemSucesso" class="success-message">
        {{ mensagemSucesso }}
      </div>
    </section>

    <!-- Loading state -->
    <div *ngIf="loading" class="loading-container">
      <div class="loading"></div>
      <p>Carregando contas...</p>
    </div>

    <!-- Listagem de contas -->
    <section *ngIf="contas.length > 0" class="accounts-section fade-in">
      <h3>Suas Contas</h3>
      <ul class="accounts-list">
        <li *ngFor="let conta of contas" class="account-item">
          <button 
            (click)="selecionarConta(conta)" 
            [class.selected]="conta === contaSelecionada" 
            class="account-button">
            ğŸ’³ {{ conta.nomeTitular }}
          </button>
        </li>
      </ul>
    </section>

    <!-- Se uma conta for selecionada -->
    <section *ngIf="contaSelecionada" class="account-details-section fade-in">
      <h3>Conta: {{ contaSelecionada.nomeTitular }}</h3>

      <!-- Saldo Atual -->
      <section class="conta-container">
        <div class="conta-detalhes">
          <p>Saldo Atual</p>
          <span class="conta-saldo">{{ contaSelecionada.saldo | currency:'BRL':'symbol':'1.2-2' }}</span>
        </div>
      </section>

      <!-- Realizar TransaÃ§Ã£o -->
      <div class="transaction-section">
        <h4>Realizar TransaÃ§Ã£o</h4>
        <input 
          type="number" 
          [(ngModel)]="valor" 
          placeholder="0.00" 
          step="0.01"
          min="0.01"
          class="input-number"
          [disabled]="loadingTransacao" />

        <div class="transaction-buttons">
          <button 
            (click)="realizarDeposito()" 
            [disabled]="!valor || valor <= 0 || loadingTransacao"
            class="btn-deposito">
            <span *ngIf="loadingTransacao && tipoTransacao === 'deposito'" class="loading"></span>
            ğŸ’° Depositar
          </button>

          <button 
            (click)="realizarSaque()" 
            [disabled]="!valor || valor <= 0 || loadingTransacao"
            class="btn-saque">
            <span *ngIf="loadingTransacao && tipoTransacao === 'saque'" class="loading"></span>
            ğŸ’¸ Sacar
          </button>
        </div>

        <div *ngIf="mensagemErro" class="error-section">
          <p class="error-message">{{ mensagemErro }}</p>
        </div>
        <div *ngIf="mensagemSucesso" class="success-message">
          {{ mensagemSucesso }}
        </div>
      </div>

      <!-- Extrato -->
      <section class="extrato-container">
        <h4 class="extrato-title">ğŸ“‹ Extrato da Conta</h4>
        <button 
          class="btn-extrato" 
          (click)="carregarExtrato()"
          [disabled]="loadingExtrato">
          <span *ngIf="loadingExtrato" class="loading"></span>
          {{ loadingExtrato ? 'Carregando...' : 'Carregar Extrato' }}
        </button>

        <div *ngIf="extrato.length > 0" class="extrato-list">
          <ul>
            <li *ngFor="let transacao of extrato" class="extrato-item">
              <span class="transacao-data">{{ transacao.dataTransacao | date:'dd/MM/yyyy HH:mm' }}</span>
              <span class="transacao-tipo">{{ transacao.tipo }}</span>
              <span 
                class="transacao-valor"
                [class.positivo]="transacao.tipo === 'DEPÃ“SITO'"
                [class.negativo]="transacao.tipo === 'SAQUE'">
                {{ transacao.tipo === 'DEPÃ“SITO' ? '+' : '-' }} {{ transacao.valor | currency:'BRL':'symbol':'1.2-2' }}
              </span>
            </li>
          </ul>
        </div>

        <div *ngIf="extrato.length === 0 && !loadingExtrato && extratoCarregado" class="no-transacoes">
          <p>Nenhuma transaÃ§Ã£o registrada ainda.</p>
        </div>
      </section>
    </section>

    <!-- ExibiÃ§Ã£o de erros -->
    <section *ngIf="erro && contas.length === 0" class="error-section">
      <p class="error-message">VocÃª ainda nÃ£o tem nenhuma conta cadastrada!</p>
    </section>
  </div>
  
  <button 
    (click)="sair()" 
    class="btn-sair">
    ğŸšª Sair
  </button>
</div>
